<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Copula III — Applications</title>
      <link href="/en/2024/03/17/6_2024-03-15-CopulasIII-Application/"/>
      <url>/en/2024/03/17/6_2024-03-15-CopulasIII-Application/</url>
      
        <content type="html"><![CDATA[<p>In this post, we may quickly go through the applications for Copulas. Firstly, let’s talk about <strong>quantile regression</strong> based on Copula, and then move to a real-world case about <strong>anomalies detection</strong>.</p><h2 id="1-Quantile-Regression"><a href="#1-Quantile-Regression" class="headerlink" title="1, Quantile Regression"></a>1, Quantile Regression</h2><h3 id="Synthetic-Data"><a href="#Synthetic-Data" class="headerlink" title="Synthetic Data"></a>Synthetic Data</h3><p>Unfortunately, I do not find a good way to synthetic data in Python, but R does provide some great functions for Copulas. I’ll use R to generate artificial data, and use Python to do the quantile regression. (However, I highly recommend to use R to do everything because R is more sophisticated, and Python module about Copula is buggy.)</p><p>Suppose $X \sim \text{Norm(100, 4)}$, $Y \sim \text{Exponential(5)}$ with rotated Clayton Copula, then use R to generate and save results.</p><pre class="line-numbers language-R" data-language="R"><code class="language-R">library(copula)library(MASS)thetaClayton&lt;-6copulaClayton_sim&lt;-claytonCopula(param&#x3D;thetaClayton,dim&#x3D;2)simData&lt;- -rCopula(500,copulaClayton_sim)+1 #rotate the data for deeper understandingplot(simData)X&lt;-qexp(simData[,1],rate&#x3D;0.2)Y&lt;-qnorm(simData[,2],mean &#x3D; 100, sd &#x3D; 4)data &#x3D; cbind(X,Y)write.csv(data, file &#x3D; &quot;synthetic_data.csv&quot;, row.names &#x3D; FALSE)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>In Python, check data distribution</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltdata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'synthetic_data.csv'</span><span class="token punctuation">)</span>X <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'X'</span><span class="token punctuation">]</span>Y <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'Y'</span><span class="token punctuation">]</span>rate <span class="token operator">=</span> <span class="token number">0.2</span><span class="token comment"># Data for the normal distribution</span>mu <span class="token operator">=</span> <span class="token number">100</span>sigma <span class="token operator">=</span> <span class="token number">4</span>fig<span class="token punctuation">,</span> axs <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>hist<span class="token punctuation">(</span>X<span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> density<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>xmin<span class="token punctuation">,</span> xmax <span class="token operator">=</span> axs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get_xlim<span class="token punctuation">(</span><span class="token punctuation">)</span>x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>xmin<span class="token punctuation">,</span> xmax<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>p <span class="token operator">=</span> rate <span class="token operator">*</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>rate <span class="token operator">*</span> x<span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> p<span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"X, rate = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>rate<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'Value'</span><span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'Density'</span><span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>hist<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> density<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">)</span>xmin<span class="token punctuation">,</span> xmax <span class="token operator">=</span> axs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get_xlim<span class="token punctuation">(</span><span class="token punctuation">)</span>x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>xmin<span class="token punctuation">,</span> xmax<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>p <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>sigma <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>x <span class="token operator">-</span> mu<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> sigma<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> p<span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Y, mu = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>mu<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">&#125;</span></span><span class="token string">, std = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>sigma<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'Value'</span><span class="token punctuation">)</span>axs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'Density'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/en/../images/6/xys.png"></p><p><img src="/en/../images/6/xyc.png"></p><h3 id="Determine-Copula"><a href="#Determine-Copula" class="headerlink" title="Determine Copula"></a>Determine Copula</h3><p>Since we generated data from Clayton Copula, so we already know we should use Clayton copula. However, let’s imagine we do not know the process of generating data, which means we do not know which Copula type we should use, and we need to determine the Copula (for now, just consider Gaussian, Clayton and Frank). </p><p>Actually, we should also hypnotize that we do not know the information about the distribution for each variable, and we should use statistical method to estimate the parameter. For convenience,  we just use the exact parameters.</p><p>The key is to plot the CDFs.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">import</span> expon<span class="token punctuation">,</span> norm<span class="token comment"># Calculate the CDF for the given values</span>U <span class="token operator">=</span> expon<span class="token punctuation">.</span>cdf<span class="token punctuation">(</span>X<span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>V <span class="token operator">=</span> norm<span class="token punctuation">.</span>cdf<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> loc<span class="token operator">=</span>mu<span class="token punctuation">,</span> scale<span class="token operator">=</span>sigma<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>U<span class="token punctuation">,</span>V<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'U'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'V'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/en/../images/6/UV.png"></p><p><img src="/en/../images/5/clayCo.png" alt="Comparison to theoretical Clayton Copula"></p><p>By the CDF plot, it’s easy to determine the copula type, isn’t it? <strong>Yes, Clayton!</strong> Here, we just have a rotated Clayton pattern.</p><p>We can rotate the data by <code>-U + 1</code> and <code>-V + 1</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">empCopula <span class="token operator">=</span> np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>U<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">)</span>empCopula_rotated <span class="token operator">=</span> <span class="token operator">-</span>empCopula <span class="token operator">+</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="Fit-Clayton-Copula"><a href="#Fit-Clayton-Copula" class="headerlink" title="Fit Clayton Copula"></a>Fit Clayton Copula</h3><p>If you haven’t installed <a href="https://sdv.dev/Copulas/index.html">copulas in python</a>, use <code>pip install copulas</code> to install.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> copulas<span class="token punctuation">.</span>bivariate <span class="token keyword">import</span> Bivariate<span class="token punctuation">,</span> Clayton<span class="token punctuation">,</span> Frankclayton <span class="token operator">=</span> Bivariate<span class="token punctuation">(</span>copula_type<span class="token operator">=</span>CopulaTypes<span class="token punctuation">.</span>CLAYTON<span class="token punctuation">)</span> <span class="token comment">#specify clayton copula</span>clayton<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>empCopula_rotated<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Create-quantile-regression-line"><a href="#Create-quantile-regression-line" class="headerlink" title="Create quantile regression line"></a>Create quantile regression line</h3><p>Usually, we are interested in 5%(lower), 50%(median) and 95%(upper) quantiles.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">theta <span class="token operator">=</span> clayton<span class="token punctuation">.</span>thetaalpha<span class="token operator">=</span><span class="token number">.05</span>quantileLow<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>alpha<span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span>theta<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>theta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> empCopula_rotated<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span>theta<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>theta<span class="token punctuation">)</span>alpha<span class="token operator">=</span><span class="token number">.5</span>quantileMid<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>alpha<span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span>theta<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>theta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> empCopula_rotated<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span>theta<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>theta<span class="token punctuation">)</span>alpha<span class="token operator">=</span><span class="token number">.95</span>quantileHigh<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>alpha<span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span>theta<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>theta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> empCopula_rotated<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span>theta<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>theta<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>empCopula_rotated<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> empCopula_rotated<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Empirical Copula'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>empCopula_rotated<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> quantileLow<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"orange"</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Quantile Low'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>empCopula_rotated<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> quantileMid<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"orange"</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Quantile Low'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>empCopula_rotated<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> quantileHigh<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"orange"</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Quantile Low'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/en/../images/6/regre1.png" alt="Quantile regression"></p><h3 id="Transform-results-to-original-data"><a href="#Transform-results-to-original-data" class="headerlink" title="Transform results to original data"></a>Transform results to original data</h3><p>The result above looks great, but we cannot understand this for original X and Y, so we need one more step to let regression line fit the original data.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">quantilesLowMidHigh <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token string">'Low'</span><span class="token punctuation">:</span> quantileLow<span class="token punctuation">,</span>    <span class="token string">'Mid'</span><span class="token punctuation">:</span> quantileMid<span class="token punctuation">,</span>    <span class="token string">'High'</span><span class="token punctuation">:</span> quantileHigh<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>mean <span class="token operator">=</span> <span class="token number">100</span>sd <span class="token operator">=</span> <span class="token number">4</span><span class="token comment"># Define the function to be applied</span><span class="token keyword">def</span> <span class="token function">transform_quantiles</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> norm<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token operator">-</span>z <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> loc<span class="token operator">=</span>mean<span class="token punctuation">,</span> scale<span class="token operator">=</span>sd<span class="token punctuation">)</span><span class="token comment"># Apply the function to each column</span>reconstrQuantiles <span class="token operator">=</span> quantilesLowMidHigh<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> z<span class="token punctuation">:</span> transform_quantiles<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Original Data'</span><span class="token punctuation">)</span><span class="token comment"># Add reconstructed quantiles points</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> reconstrQuantiles<span class="token punctuation">[</span><span class="token string">'Low'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Low Quantile'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> reconstrQuantiles<span class="token punctuation">[</span><span class="token string">'Mid'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Mid Quantile'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> reconstrQuantiles<span class="token punctuation">[</span><span class="token string">'High'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'High Quantile'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Predictor'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Output'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/en/../images/6/regref.png" alt="Looks cool!"></p><h2 id="2-Anomalies-Detection"><a href="#2-Anomalies-Detection" class="headerlink" title="2, Anomalies Detection"></a>2, Anomalies Detection</h2>]]></content>
      
      
      <categories>
          
          <category> Mathematics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Probability </tag>
            
            <tag> Mathematics </tag>
            
            <tag> Machine Learning </tag>
            
            <tag> Linear &amp; Nonlinear Analysis </tag>
            
            <tag> Data Analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Copula II — Definition</title>
      <link href="/en/2024/03/15/5_2024-03-13-CopulasII-Definition/"/>
      <url>/en/2024/03/15/5_2024-03-13-CopulasII-Definition/</url>
      
        <content type="html"><![CDATA[<p>The word <strong><a href="https://en.wikipedia.org/wiki/Copula_(linguistics)">Copula</a></strong> derives from the Latin noun for a “link” or “tie” that connects two different things. When I talk about Copula in this post, actually I mean the <a href="https://en.wikipedia.org/wiki/Copula_(probability_theory)">Sklar’s Theorem</a>. </p><p>Here is what the Sklar’s Theorem tells us: we always can find a <em>Copula function</em> \(C\) that every multivariate (a.k.a joint) cumulative distribution function(CDF) can be expressed by its marginal CDFs. In other words, we can use copula function to analyze the dependence between each random variable, and Sklar’s Theorem ensures such copula function exists.</p><h2 id="Copula-Sklar’s-Theorem"><a href="#Copula-Sklar’s-Theorem" class="headerlink" title="Copula &amp; Sklar’s Theorem"></a>Copula &amp; Sklar’s Theorem</h2><blockquote><p><strong>Definition</strong>: A \(\textbf{copula}\) is a function \(C: [0, 1]^n \rightarrow [0, 1]\) with the following properties: </p><ul><li><p>For every \(u_1, u_2, \ldots, u_n \in [0, 1]\), \(C(1, 1, \ldots, u_i, \ldots, 1) &#x3D; u_i\). </p></li><li><p>For every \(u_1, u_2, \ldots, u_n \in [0, 1]\), if any \(u_i &#x3D; 0\), then \(C(u_1, u_2, \ldots, u_n) &#x3D; 0\). </p></li><li><p>\(C\) is \(\textbf{n-increasing}\), meaning that for any \(a_1 \leq b_1, a_2 \leq b_2, \ldots, a_n \leq b_n\) in \([0, 1]\), the C-volume of the n-dimensional interval \([a_1, b_1] \times [a_2, b_2] \times \ldots \times [a_n, b_n]\) is nonnegative. That is,  $$\begin{equation} \Delta C \geq 0, \end{equation}$$ where $\Delta C$ is the C-volume, a difference of values of $C$ that resembles a high-dimensional version of the finite difference. </p><blockquote><p>Note: Given a copula $C: [0, 1]^n \rightarrow [0, 1]$, the $\Delta C$ for a box defined by the intervals $[a_1, b_1], [a_2, b_2], \ldots, [a_n, b_n]$ in $[0, 1]^n$ is calculated as follows: $$\begin{equation} \Delta C &#x3D; \sum_{(i_1, i_2, \ldots, i_n) \in {0,1}^n} (-1)^{i_1 + i_2 + \cdots + i_n} C\left(b_1^{(i_1)}, b_2^{(i_2)}, \ldots, b_n^{(i_n)}\right), \end{equation}$$ where $b_j^{(i_j)} &#x3D; a_j$ if $i_j &#x3D; 0$ and $b_j^{(i_j)} &#x3D; b_j$ if $i_j &#x3D; 1$ for $1 \leq j \leq n$. This formula applies the inclusion-exclusion principle to calculate the volume under the copula over the specified box.</p><p>Consider a 2-dimensional copula $C: [0, 1]^2 \rightarrow [0, 1]$. To calculate the $\Delta C$ for a box in $[0, 1]^2$ defined by the intervals $[a_1, b_1]$ and $[a_2, b_2]$, we use the formula: \begin{equation} \Delta C &#x3D; C(b_1, b_2) - C(a_1, b_2) - C(b_1, a_2) + C(a_1, a_2). \end{equation} This represents the inclusion-exclusion principle in 2 dimensions, ensuring that we correctly account for the volume under $C$ over the box by subtracting and adding the values of $C$ at the corners of the box. </p><p>In one word, we just want to make sure the volume inside the squre (\([0, 1] \times[0,1]\)) is positive. (Review the probability from joint CDF. For example, \(P(a_1&lt;X&lt;a_2, b_1&lt;Y&lt;b_2)\))</p></blockquote></li></ul><p><strong>Sklar’s Theorem</strong>: For any joint distribution function \(H\) of random variables \(X_1, X_2, \ldots, X_n\) with marginal distribution functions \(F_1, F_2, \ldots, F_n\), there <strong>exists</strong> a copula \(C: [0, 1]^n \rightarrow [0, 1]\) such that for all \(x_1, x_2, \ldots, x_n\) in the extended real line (\(\overline{\mathbb{R}}\) or \(\mathbb{R} \cup \{-\infty,\infty\}\)), $$\begin{equation} H(x_1, x_2, \ldots, x_n) &#x3D; C(F_1(x_1), F_2(x_2), \ldots, F_n(x_n)). \end{equation}$$ Furthermore, if the marginal distribution functions \(F_1, F_2, \ldots, F_n\) are continuous, then the copula \(C\) is <strong>unique</strong>. This means that the joint distribution \(H\) can be fully specified by its marginals and the copula \(C\).</p><blockquote><p><strong>Brief Proof</strong>: Currently, we only consider continuous case (CDF can be discontinuous, but that requires lots of math, and I don’t understand it 🙃. It I think is necessary, I may update in the future though I think continuous case is enough for most scenarios).</p><ol><li><p><strong>existence</strong>: Here, we use the definition of generalized inverse distribution function where </p><p>$$F^{-1}_X(y) &#x3D; \inf\{x : F_X(x) \geq y\}, \quad  0 \leq y \leq 1.$$</p><p>By <a href="https://zcpisme.github.io/en/2024/03/10/4_Probability%20%E2%80%94%20Probability%20Integral%20Transform/">Probability Integral Transform</a>, we know $U_i &#x3D; F_i(X_i)$ is normally distributed on $[0,1]$ for $i &#x3D; 1, 2,…,n$. We can easily construct copula function $C : [0, 1]^n \rightarrow [0, 1]$ s.t</p><p>$$C(u_1, u_2, …, u_n) &#x3D; H(F^{-1}_1, F^{-1}_2,…, F^{-1}_n).$$</p><p>Here, $C(1,…,1,u_i,1,…,1) &#x3D; u_i$ and $C(u_1,…,u_{i-1},0 ,u_{i+1},…,u_n) &#x3D; 0$ are obvious because it just means marginal CDF or the probability of a single point, which is 0. Also, $C$ is $n$-increasing because we define it from CDFs, which is non-negative for sure.</p></li><li><p><strong>uniqueness</strong>(skip): Simply because the continuous marginal CDF is one-to-one (bijective) function, so each copula has to follow same “mapping way” to connect marginal CDFs and joint CDF.</p></li></ol></blockquote></blockquote><h2 id="Type-of-Copulas"><a href="#Type-of-Copulas" class="headerlink" title="Type of Copulas"></a>Type of Copulas</h2><p>Theoretically, there are infinite types of Copula functions based on different distributions. I’ll introduce some common Copulas in bivariate distribution.</p><h3 id="1-Gaussian-Copula"><a href="#1-Gaussian-Copula" class="headerlink" title="1, Gaussian Copula"></a>1, Gaussian Copula</h3><ul><li><strong>Symmetry</strong>: Gaussian copulas are symmetric, meaning they assign equal probability to joint tail events.</li><li><strong>No Tail Dependence</strong>: Gaussian copulas do not have tail dependence, implying that they underestimate the probability of extreme co-movements.</li></ul><p>General Formula: $C(u,v;\theta) &#x3D; \Phi_{\theta}(\Phi^{-1}(u), \Phi^{-1}(v))$</p><p>Conditional Copulas: $C_{2|1}^{-1}{ \alpha | u } &#x3D; \Phi \left( \Phi^{-1}(\alpha) \sqrt{1-\theta^2} + \theta\Phi^{-1}(u) \right)$, $\theta \in [-1,1]$</p><p><img src="/en/../images/5/gauCo.png" alt="$\theta = 0.7$"></p><h3 id="2-Gumbel-Copula"><a href="#2-Gumbel-Copula" class="headerlink" title="2, Gumbel Copula"></a>2, Gumbel Copula</h3><ul><li><strong>Asymmetry</strong>: The Gumbel copula is asymmetric, with more weight on the joint upper tails, capturing the events where both variables achieve high values together.</li><li><strong>Upper Tail Dependence</strong>: It exhibits upper tail dependence but not lower tail dependence.</li></ul><p>General Formula: $C(u,v;\theta) &#x3D; \exp\left( -\left[ (-\log u)^\theta + (-\log v)^\theta \right]^{1&#x2F;\theta} \right)$</p><p>Conditional Copulas (Skip): Gumbel copula does not have an explicit expression. Instead, we may use numerical method to simulate.</p><p><img src="/en/../images/5/gumCo.png" alt="$\theta = 3$"></p><h3 id="3-Clayton-Copula"><a href="#3-Clayton-Copula" class="headerlink" title="3, Clayton Copula"></a>3, Clayton Copula</h3><ul><li><strong>Asymmetry</strong>: Clayton copulas are asymmetric, with more weight on the joint lower tails, indicating that they capture the events where both variables achieve low values together.</li><li><strong>Lower Tail Dependence</strong>: It exhibits strong lower tail dependence but no upper tail dependence.</li></ul><p>General Formula: $C(u,v;\theta) &#x3D; \left( u^{-\theta} + v^{-\theta} - 1 \right)^{-1&#x2F;\theta}$</p><p>Conditional Copulas: $C_{2|1}^{-1}{ \alpha | u } &#x3D; \left( \left(\alpha^{-\theta} - 1 \right) u^{-\theta} + 1 \right)^{-1&#x2F;\theta}$, $1 \leq \theta &lt; \infty$</p><p><img src="/en/../images/5/clayCo.png" alt="$\theta = 5$"></p><h3 id="4-Frank-Copula"><a href="#4-Frank-Copula" class="headerlink" title="4, Frank Copula"></a>4, Frank Copula</h3><ul><li><strong>Symmetry</strong>: Frank copulas are symmetric, treating the dependence in the lower and upper tails equally.</li><li><strong>No Tail Dependence</strong>: Frank copulas do not exhibit tail dependence, similar to Gaussian copulas.</li></ul><p>General Formula: $C(u,v;\theta) &#x3D; -\frac{1}{\theta} \ln\left( 1 + \frac{(e^{-\theta u} - 1)(e^{-\theta v} - 1)}{e^{-\theta} - 1} \right)$</p><p>Conditional Copulas: $C_{2|1}^{-1}{ \alpha | u } &#x3D; -\frac{1}{\theta} \ln \left( 1 - \frac{\alpha (1 - \exp(-\theta))}{\exp(-\theta u) + \alpha (1 - \exp(-\theta u))} \right)$, $\theta \in \mathbb{R} \backslash \{0\}$</p><p><img src="/en/../images/5/frankCo.png" alt="$\theta = 10$"></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Feel tedious, right? So, let’s just forget everything above, and just remember: </p><ol><li>“Copula(s)” refers a family of functions that help us understand how different things, like variables or data points, move together or relate to each other, despite having their own unique behaviors.</li><li>Sklar’s Theorem ensures the existence and uniqueness of copulas for continuous marginal CDFs.</li></ol><p>I also wanted to write some applications for Copulas, but I figured out that I’ve written too long for the boring mathematics stuff. Let’s finish this in the next post, and see you soon~</p>]]></content>
      
      
      <categories>
          
          <category> Mathematics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Probability </tag>
            
            <tag> Mathematics </tag>
            
            <tag> Machine Learning </tag>
            
            <tag> Linear &amp; Nonlinear Analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Copulas I — Probability Integral Transform</title>
      <link href="/en/2024/03/10/4_2024-03-10-CopulasI-Probability%20Integral%20Transform/"/>
      <url>/en/2024/03/10/4_2024-03-10-CopulasI-Probability%20Integral%20Transform/</url>
      
        <content type="html"><![CDATA[<p> When I wrote this article, I was enjoying my spring break after winter quarter (Greetings from Atlanta😃). Initially, my intention was to delve into the intricacies of Copulas. However, I realized the paramount importance of laying a solid foundation by elucidating the basic concept of the Probability Integral Transform before advancing further.</p><h2 id="Definition-Proof"><a href="#Definition-Proof" class="headerlink" title="Definition &amp; Proof"></a>Definition &amp; Proof</h2><blockquote><p><strong>Definition</strong>: For a random variable \(X\), the function \(F\) defined by </p><p>$$F_{X}(x) &#x3D; P(X \leq x),\quad x \in \mathbb{R}$$, is called is called the cumulative distribution function (<strong>CDF</strong>) or, more simply, the distribution function of \(X\).</p></blockquote><p>It’s crucial to recognize that the CDF is a non-decreasing function. This implies that if \(a \leq b\), then \(F_X(a) \leq F_X(b)\). With this understanding in place, let’s turn our attention to the focal point of today’s discussion: <strong>Probability Integral Transform</strong>.</p><blockquote><p><strong>Theorem</strong>: Suppose that a random variable \(X\) has a continuous distribution for which the cumulative distribution function (CDF) is \(F_{X}\). The random variable \(Y\) defined as \(Y :&#x3D; F_X(X)\), then </p><p>$$Y  \sim \text{Uniform}(0, 1)$$</p><blockquote><p><strong>proof</strong>: Since \(Y &#x3D; F_X(X)\), \(0 \leq y \leq 1\), this also leads to \(P(Y &gt; 1) &#x3D; P(Y &lt; 0) &#x3D; 0\). Also, \(P(F_X(X) \leq y) &#x3D; P(X \leq F^{-1}_X(y))\) because \(P(F_X(X) \leq y)\) simply means we want to find a \(x\) such that \(y\) is the quantile of \(X\).</p><p>Thus, we can get,</p><p>$$\begin{equation} \label{eq2}<br>\begin{aligned}<br>F_Y(y) &amp;&#x3D; P(Y \leq y)  \\<br>    &amp;&#x3D; P(F_X(X) \leq y) \\<br>       &amp;&#x3D; P(X \leq F_X^{-1}(y)) \\<br>       &amp;&#x3D; F_X(F_X^{-1}(y)) \\<br>       &amp;&#x3D; y<br>   \end{aligned}<br>\end{equation}$$</p></blockquote><blockquote><p><strong>Note</strong>: The proof hinges on the increasing of \(F^{-1}_X(y)\). In cases where \(F^{-1}_X(y)\) does not increase (for example, if \(F_X\) is constant between \(x_0\) and \(x_1\)), we can employ a generalized form: </p><p>$$F^{-1}_X(y) &#x3D; \inf\{x : F_X(x) \geq y\}$$</p><p>Following this definition leads to the same conclusion.</p></blockquote></blockquote><h2 id="Applications"><a href="#Applications" class="headerlink" title="Applications"></a>Applications</h2><p><strong>Simulation of Random Variables</strong>:</p><p>Imagine the challenge of selecting a random number that adheres to the standard normal distribution—or any distribution for that matter. It’s not as simple as randomly choosing a number and declaring, “This follows a normal distribution!” Fortunately, there’s a clever approach to ensure accuracy.</p><ul><li>Start by selecting a number from a uniform distribution, which essentially means choosing any number between 0 and 1.</li><li>Next, calculate the inverse cumulative distribution function (CDF) of the standard normal distribution, denoted as \(x &#x3D; \Phi^{-1}(u)\). The resulting \(x\) is precisely what we’re looking for: a value that conforms to the standard normal distribution.</li></ul><p><strong>Copulas</strong>:</p><p>Intuitively, this method helps us to understand the randomness and dependence of random variables, but let’s talk about this in the next post. </p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>We briefly introduced an amazing theorem, Probability Integral Transform. In one words, PIT tells us that the probabilities of outcomes for any random variable into a uniform distribution. This theorem is essential for Copula, and see you next time.</p>]]></content>
      
      
      <categories>
          
          <category> Mathematics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Probability </tag>
            
            <tag> Mathematics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Simple NLP — Sentiment Analysis</title>
      <link href="/en/2024/03/08/3_2024-03-08-Simple%20NLP%20%E2%80%94%20Sentiment%20Analysis/"/>
      <url>/en/2024/03/08/3_2024-03-08-Simple%20NLP%20%E2%80%94%20Sentiment%20Analysis/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Translated by ChatGPT</p></blockquote><p>A few days ago, during an interview, the interviewer suddenly asked me, “Why are you interested in pursuing a major related to data science?” I was momentarily at a loss for words. Saying it was purely out of love seemed somewhat insincere—it’s all about making a living, after all. There aren’t always grand narratives or beautiful visions.</p><p>However, I answered the interviewer like this: I said that perhaps, without us knowing, some simple data analyses could bring us a lot of information. This information could be business-related, societal, or even personal. I have the habit of keeping a daily diary (although most of it is just rambling…), and just a few days ago, I ran a simple sentiment analysis on my daily diaries using an open-source model from Hugging Face. I told the interviewer that, maybe, data analysis could also help me understand myself better.</p><p>So, I decided to start a “Simple” series, which is just about using libraries without needing deep technical knowledge.</p><h2 id="0，My-Diary"><a href="#0，My-Diary" class="headerlink" title="0，My Diary"></a>0，My Diary</h2><p><img src="/en/../images/3/1_diary.jpg"></p><p>This is my habit of keeping a diary, writing some words, and then not using any punctuation marks (this is quite perverse), using line breaks to separate sentences. In Python, the data looks something like this: <img src="/en/../images/3/1_diary2.jpg"></p><p>What I actually need is the content in <code>diary_item_content</code>. After a series of operations to extract the content, I do some simple preprocessing in preparation for analysis. (No code here, as everyone has their own diary writing habits.)</p><p><img src="/en/../images/3/1_diary3.jpg" alt="just replacing line breaks with periods lol"></p><h2 id="1，-Direct-Use-of-Online-Models"><a href="#1，-Direct-Use-of-Online-Models" class="headerlink" title="1， Direct Use of Online Models"></a>1， Direct Use of Online Models</h2><h3 id="1-1-Hugging-Face"><a href="#1-1-Hugging-Face" class="headerlink" title="1.1 Hugging Face"></a>1.1 Hugging Face</h3><p>At <a href="https://huggingface.co/models">Hugging Face</a>, there are many deep models available for selection. These can be used for fine-tuning or directly out of the box. (Take it and use it!)</p><p>I selected <a href="https://huggingface.co/touch20032003/xuyuan-trial-sentiment-bert-chinese">xuyuan-trial-sentiment-bert-chinese</a>, a sentiment analysis model fine-tuned on a Chinese dataset with BERT. Input text, and the output is roughly as follows:</p><p><img src="/en/../images/3/2_modelExp.jpg" alt="Probabilities for different sentiments"></p><p>At first glance, it seems pretty accurate.</p><h3 id="1-2-Python-Usage"><a href="#1-2-Python-Usage" class="headerlink" title="1.2 Python Usage"></a>1.2 Python Usage</h3><p>Using it in Python is straightforward, just:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> transformers <span class="token keyword">import</span> pipeline <span class="token comment"># Direct use of high-level API</span>pipe <span class="token operator">=</span> pipeline<span class="token punctuation">(</span><span class="token string">"text-classification"</span><span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">"touch20032003/xuyuan-trial-sentiment-bert-chinese"</span><span class="token punctuation">)</span> <span class="token comment">#Model is selectable</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>使用例：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pipe<span class="token punctuation">(</span><span class="token string">'Today I came to Tampa. It is sunshine and beaches. Fine sand and a calm, leisurely life. Not many people around. Seagulls flying around people. If possible, I would like to live here longer.'</span><span class="token punctuation">)</span><span class="token comment"># output: [&#123;'label': 'happiness', 'score': 0.8051121234893799&#125;]</span><span class="token comment">#or</span>pipe<span class="token punctuation">(</span><span class="token string">'Today I came to Tampa. It is sunshine and beaches. Fine sand and a calm, leisurely life. Not many people around. Seagulls flying around people. If possible, I would like to live here longer.'</span><span class="token punctuation">,</span> top_k<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token comment"># top_k = None returns all categories</span><span class="token comment">#[&#123;'label': 'happiness', 'score': 0.8051121234893799&#125;,</span><span class="token comment"># &#123;'label': 'like', 'score': 0.18319253623485565&#125;,</span><span class="token comment"># &#123;'label': 'disgust', 'score': 0.006669812370091677&#125;,</span><span class="token comment"># &#123;'label': 'anger', 'score': 0.0025043778587132692&#125;,</span><span class="token comment"># &#123;'label': 'fear', 'score': 0.0013982513919472694&#125;,</span><span class="token comment"># &#123;'label': 'surprise', 'score': 0.0004570793535094708&#125;,</span><span class="token comment"># &#123;'label': 'none', 'score': 0.0004206936282571405&#125;,</span><span class="token comment"># &#123;'label': 'sadness', 'score': 0.0002451551263220608&#125;]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="1-3-Simple-“For-Loop”"><a href="#1-3-Simple-“For-Loop”" class="headerlink" title="1.3 Simple “For Loop”"></a>1.3 Simple “For Loop”</h3><p>Not posting the code here, as it varies according to specific situations. Plus, it’s too crudely written to show off.</p><p>I stored the results in a dictionary, with the key being the diary entry number, and the value being the sentiments of different paragraphs.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token comment">#&#123;0: &#123;0: 'like', 1: 'anger'&#125;,</span><span class="token comment"># 1: &#123;0: 'happiness', 1: 'like', 2: 'sadness', 3: 'disgust', 4: 'happiness'&#125;,</span><span class="token comment"># 2: &#123;0: 'sadness', 1: 'sadness'&#125;,</span><span class="token comment"># 3: &#123;0: 'disgust', 1: 'none', 2: 'sadness'&#125;,</span><span class="token comment"># 4: &#123;0: 'disgust', 1: 'happiness'&#125;,</span><span class="token comment"># 5: &#123;0: 'sadness'&#125;,</span><span class="token comment"># 6: &#123;1: 'disgust'&#125;,</span><span class="token comment"># .....</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You could save it locally as a pickle:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pickle<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'DiarySentimentRes'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>  pickle<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>res<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="2-My-Sentiments"><a href="#2-My-Sentiments" class="headerlink" title="2,  My Sentiments"></a>2,  My Sentiments</h2><p>Next, I tallied the count of each emotion.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">sentiCount <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'sadness'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'happiness'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'like'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'anger'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'surprise'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'disgust'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'fear'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'none'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> res<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">for</span> m<span class="token punctuation">,</span>n <span class="token keyword">in</span> j<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">list</span><span class="token punctuation">:</span>      <span class="token keyword">for</span> k <span class="token keyword">in</span> n<span class="token punctuation">:</span>        sentiCount<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      sentiCount<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>sentiCount<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''&#123;'sadness': 1227, 'happiness': 1075, 'like': 784, 'anger': 550, 'surprise': 129, 'disgust': 918, 'fear': 106, 'none': 558&#125;'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>(It turns out happiness and sadness are almost equally distributed, probably because I only remember to write my diary late at night, hence the deep-night emo moments 😟)</p><p>I simply plotted a pie chart,</p><p><img src="/en/../images/3/3_sentpie.jpg" alt="happy to see I&#39;m emotional"></p><h2 id="3，-Some-Basic-Concepts"><a href="#3，-Some-Basic-Concepts" class="headerlink" title="3， Some Basic Concepts"></a>3， Some Basic Concepts</h2><p>In today’s AI-booming era, operations have gradually become simplified, allowing for direct model usage without the need for extensive explanations. Most people can quickly get involved and learn about their interests in AI. AI drawing even has open-source graphical interfaces, eliminating the need for even basic programming languages like Python. Thus, everything seems simple (at least if you don’t delve too deep, perhaps).</p><p>Back to sentiment analysis, one could actually train a classifier themselves (SVM, Logistic Regression, etc.), and the results might not necessarily be worse than those of so-called deep learning models. Frankly, if there’s an appropriate dataset, hard training might yield even better results.</p><h2 id="4，-一些小概念"><a href="#4，-一些小概念" class="headerlink" title="4， 一些小概念"></a>4， 一些小概念</h2><p>Indeed, I prefer to discuss conceptual stuff later on, as starting with all sorts of technical jargon can be headache-inducing.</p><ul><li>Transformer: An encoder-decoder architecture that shone brightly after being mentioned in <a href="https://arxiv.org/abs/1706.03762">Attention is All You Need</a>.</li><li>Encoder: The Encoder understands the content of an article and passes the information to the Decoder.</li><li>Decoder: Generates corresponding tasks using the results given by the Encoder.</li><li>BERT (Bidirectional Encoder Representations from Transformers): The encoder part of a transformer, usually used for article classification, named entity recognition, and other tasks.</li><li>GPT (Generative Pretrained Transformer): In contrast to BERT, it uses only the decoder part, typically for generative tasks.</li></ul>]]></content>
      
      
      <categories>
          
          <category> Natural Language Processing (NLP) </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Natural Language Processing </tag>
            
            <tag> Deep Learning </tag>
            
            <tag> Sentiment Analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Advanced Hexo Setup Tips, 2024 Edition</title>
      <link href="/en/2024/03/06/2_2024-03-06-HexoSetup/"/>
      <url>/en/2024/03/06/2_2024-03-06-HexoSetup/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Translated by ChatGPT</p></blockquote><p>In the previous article, we built a very basic website. This time, let’s take a look at some personal configurations I plan to make in 2024.</p><p>In fact, the <a href="https://github.com/blinkfox/hexo-theme-matery">original documentation</a> and blogger <a href="https://marmalade.vip/about">lijunliang</a>‘s articles have already provided very detailed instructions, which are likely clearer and easier to understand than what an outsider like me could write.</p><p>However, these articles might be a bit dated, and some additional configurations may be necessary in 2024. This article will briefly introduce the changes I’ve made.</p><h2 id="1-Code-Block-Highlighting"><a href="#1-Code-Block-Highlighting" class="headerlink" title="1. Code Block Highlighting"></a>1. Code Block Highlighting</h2><p>In the original documentation regarding highlighting code blocks, it states:</p><blockquote><p>Starting from <strong>Hexo 5.0.0 version</strong>, it comes with support for <code>prismjs</code> code syntax highlighting, and hexo-theme-matery has been modified to support it.</p><p>If the plugin of <code>hexo-prism-plugin</code> has been installed in your blog, then you need to execute <code>npm uninstall hexo-prism-plugin</code> to uninstall it, otherwise there will be <code>&#123;</code>, <code>&#125;</code> escape characters in the code block of the post.</p><p>Then, modify the value of <code>highlight.enable</code> to <code>false</code> in <code>_config.yml</code> at the root your hexo project, and set the value of <code>prismjs.enable</code> to <code>true</code>, the main configuration is as follows:</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">></span>highlight<span class="token punctuation">:</span> <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token key atrule">auto_detect</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span> <span class="token key atrule">wrap</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token key atrule">hljs</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token punctuation">></span>prismjs<span class="token punctuation">:</span> <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token key atrule">preprocess</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><p>However, the actual situation is that, by 2024, Hexo has reached version 7+ (check the version with <code>hexo -v</code> in cmd). In the official documentation, a new <code>syntax_highlighter: highlight.js</code> configuration has been added, so based on this, you need to change the highlight section in the root directory’s _config.yml file to:</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">syntax_highlighter</span><span class="token punctuation">:</span> prismjs <span class="token comment">#declare prismjs</span><span class="token key atrule">highlight</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">auto_detect</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span>  <span class="token key atrule">wrap</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">hljs</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">prismjs</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">preprocess</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>The before and after effects are as follows:</p><p><img src="/en/../images/2/1_highlightcompare.png"></p><p><img src="/en/../images/2/1_highlightcompareafter.png"></p><h2 id="2-Code-Compression"><a href="#2-Code-Compression" class="headerlink" title="2. Code Compression"></a>2. Code Compression</h2><p>In <a href="https://marmalade.vip/Materysettings2.html">this article</a>, the author uses Gulp to compress code and images to speed up the website. However, since 2022, some commonJS packages have moved entirely to ESM. For example, <code>del</code> v7.0.0 in the original commonJS no longer supports commonJS and ESM simultaneously but supports ESM only, as stated in the <a href="https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c">original text</a>:</p><blockquote><p>The package that linked you here is now pure <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules">ESM</a>. It cannot be <code>require()</code>‘d from CommonJS.</p></blockquote><p>For these ESM packages, you need to use import() instead of require().</p><p>Therefore, a few additional steps are needed based on the original tutorial:</p><h3 id="2-1-Installing-esm"><a href="#2-1-Installing-esm" class="headerlink" title="2.1, Installing esm"></a>2.1, Installing esm</h3> <pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">npm install gulp -g # Install gulp# Install functional modules npm install gulp-htmlclean gulp-htmlmin gulp-minify-css gulp-uglify gulp-imagemin --save # Additional functional modules npm install gulp-debug gulp-clean-css gulp-changed gulp-if gulp-plumber gulp-babel babel-preset-es2015 del --savenpm i --save-dev esm -g # New, install esm<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>And rename the file <code>gulpfile.js</code> to <code>gulpfile.mjs</code></p><h3 id="2-2-Changing-require-to-import"><a href="#2-2-Changing-require-to-import" class="headerlink" title="2.2, Changing require() to import()"></a>2.2, Changing require() to import()</h3><p>At the beginning of gulpfile.js, change all instances of require to <code>import xxx from &#39;gulp-xxx&#39;</code></p><p>Before change</p><blockquote><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">></span><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">></span><span class="token keyword">var</span> debug <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">></span><span class="token keyword">var</span> cleancss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-clean-css"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// CSS compression component </span><span class="token operator">></span><span class="token keyword">var</span> uglify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-uglify"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// JS compression component </span><span class="token operator">></span><span class="token keyword">var</span> htmlmin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-htmlmin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HTML compression component </span><span class="token operator">></span><span class="token keyword">var</span> htmlclean <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-htmlclean"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HTML cleaning component </span><span class="token operator">></span><span class="token keyword">var</span> imagemin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-imagemin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Image compression component </span><span class="token operator">></span><span class="token keyword">var</span> changed <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-changed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// File change verification component </span><span class="token operator">></span><span class="token keyword">var</span> gulpif <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-if"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Task helper calling component </span><span class="token operator">></span><span class="token keyword">var</span> plumber <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-plumber"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Fault tolerance component (continue task on error and report error content) </span><span class="token operator">></span><span class="token keyword">var</span> isScriptAll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Whether to process all files, (true|process all files)(false|only process changed files) </span><span class="token operator">></span><span class="token keyword">var</span> isDebug <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Whether to debug display compiled files </span><span class="token operator">></span><span class="token keyword">var</span> gulpBabel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gulp-babel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">></span><span class="token keyword">var</span> es2015Preset <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"babel-preset-es2015"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">></span><span class="token keyword">var</span> del <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"del"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">></span><span class="token keyword">var</span> Hexo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"hexo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">></span>Source<span class="token operator">:</span> Marmalade's Blog<span class="token operator">></span>Author<span class="token operator">:</span> lijunliang<span class="token operator">></span>Article link<span class="token operator">:</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>marmalade<span class="token punctuation">.</span>vip<span class="token operator">/</span>Materysettings2<span class="token punctuation">.</span>html<span class="token operator">></span>This article is copyrighted by the author<span class="token punctuation">,</span> any form <span class="token keyword">of</span> reprinting should cite the source<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><p>After change</p><pre class="line-numbers language-ejs" data-language="ejs"><code class="language-ejs">import gulp from 'gulp';import debug from 'gulp-debug';import cleancss from 'gulp-clean-css';import uglify from 'gulp-uglify';import htmlmin from 'gulp-htmlmin';import htmlclean from 'gulp-htmlclean';import imagemin from 'gulp-imagemin';import changed from 'gulp-changed';import gulpif from 'gulp-if';import plumber from 'gulp-plumber';import gulpBabel from 'gulp-babel';import es2015Preset from 'babel-preset-es2015';import &#123; deleteAsync &#125; from 'del';import Hexo from 'hexo';<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Keep the rest unchanged.</p><h3 id="2-3-Starting-Gulp-Compression-Before-Deployment"><a href="#2-3-Starting-Gulp-Compression-Before-Deployment" class="headerlink" title="2.3, Starting Gulp Compression Before Deployment"></a>2.3, Starting Gulp Compression Before Deployment</h3><p>The original steps for deploying the webpage to GitHub were:</p><blockquote><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">hexo cleanhexo ghexo d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote><p>Now it is:</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">hexo cleanhexo ggulp # Start Gulp compression, console can check for errorshexo d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-Bilingual-Personal-Website"><a href="#3-Bilingual-Personal-Website" class="headerlink" title="3. Bilingual Personal Website"></a>3. Bilingual Personal Website</h2><p>This requirement has not yet found a universal solution. Hexo provides a solution called <a href="https://hexo.io/docs/internationalization.html">Internationalization (i18n)</a>, which essentially involves creating separate folders for two languages in the source file and then placing articles in the corresponding folders. However, in practice, especially when applying a preset theme, various difficulties may arise. Some themes, such as <a href="https://github.com/next-theme/hexo-theme-next">NexT</a>, have already adapted the feature for language switching. Unfortunately, the <a href="https://github.com/blinkfox/hexo-theme-matery">matery</a> theme used in this article does not seem to have this feature. Of course, experts can achieve this function by modifying the code. But is there a simpler way?</p><h3 id="3-1-Preliminary-Idea"><a href="#3-1-Preliminary-Idea" class="headerlink" title="3.1, Preliminary Idea"></a>3.1, Preliminary Idea</h3><p>Of course, there is. Essentially, what we want is a <strong>set</strong> of different interfaces, so it can be understood that the main interface is in Chinese, and then by adding a suffix like <code>/en</code> to the URL, it jumps to the English interface.</p><p>In other words, we can directly create two repositories to implement the mutual jump between the two URLs.</p><p>Fortunately, in GitHub’s personal URLs, although an account can only have one free user page, there can be many project pages.</p><blockquote><p>For example, <a href="https://zcpisme.github.io/">https://zcpisme.github.io/</a> is my user page, and if I have a project called myProject, the URL of this project would be <a href="https://zcpisme.github.io/myProject">https://zcpisme.github.io/myProject</a></p></blockquote><h3 id="3-2-The-Second-Repository"><a href="#3-2-The-Second-Repository" class="headerlink" title="3.2, The Second Repository"></a>3.2, The Second Repository</h3><p>This is simple. We copy the project folder of the Chinese website, rename it (arbitrarily named, but for convenience, I will call it myFirstBlog.en).</p><p>Create a new repository on GitHub, named en. The result is as follows:</p><p><img src="/en/../images/2/2_enGit.png"></p><h3 id="3-3-1-Modify-the-Configuration-Files-in-the-myFirstBlog-en-Folder"><a href="#3-3-1-Modify-the-Configuration-Files-in-the-myFirstBlog-en-Folder" class="headerlink" title="3.3.1, Modify the Configuration Files in the myFirstBlog.en Folder"></a>3.3.1, Modify the Configuration Files in the myFirstBlog.en Folder</h3><p>In the root directory’s _config.yml:</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># Site</span><span class="token key atrule">title</span><span class="token punctuation">:</span> Hexo<span class="token key atrule">subtitle</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token key atrule">language</span><span class="token punctuation">:</span> en <span class="token comment"># Change to en</span><span class="token comment"># URL</span><span class="token comment">## Set your site url here. For example, if you use GitHub Page, set url as 'https://username.github.io/project'</span><span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//zcpisme.github.io/en/  <span class="token comment"># Add en to the original basis</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># Deployment</span><span class="token comment">## Docs: https://hexo.io/docs/one-command-deployment</span><span class="token key atrule">deploy</span><span class="token punctuation">:</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span> git  <span class="token key atrule">repo</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/zcpisme/en.git <span class="token comment"># Repository address for the en webpage</span>  <span class="token key atrule">branch</span><span class="token punctuation">:</span> gh<span class="token punctuation">-</span>pages <span class="token comment"># Push to gh-pages</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>In the theme’s _config.yml, add a button hyperlink to the Chinese page:</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">menu</span><span class="token punctuation">:</span>  <span class="token key atrule">Index</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>home  <span class="token key atrule">Tags</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /tags    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>tags  <span class="token key atrule">Categories</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /categories    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>bookmark  <span class="token key atrule">Archives</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /archives    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>archive  <span class="token key atrule">About</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /about    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>user<span class="token punctuation">-</span>circle  <span class="token comment"># add a Chinese button</span>  <span class="token key atrule">Chinese</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//zcpisme.github.io/  <span class="token comment"># Directly jump to the Chinese site</span>    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>language<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-3-2-Modify-the-Configuration-Files-in-the-myFirstBlog-Folder"><a href="#3-3-2-Modify-the-Configuration-Files-in-the-myFirstBlog-Folder" class="headerlink" title="3.3.2, Modify the Configuration Files in the myFirstBlog Folder"></a>3.3.2, Modify the Configuration Files in the myFirstBlog Folder</h3><p>In the root directory’s _config.yml:</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># Site</span><span class="token key atrule">title</span><span class="token punctuation">:</span> Hexo<span class="token key atrule">subtitle</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token key atrule">language</span><span class="token punctuation">:</span> zh<span class="token punctuation">-</span>CN <span class="token comment"># Change to Chinese</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>Similarly, we just need to add a button to the English site in the theme’s _config.yml:</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">menu</span><span class="token punctuation">:</span>  <span class="token key atrule">Index</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>home  <span class="token key atrule">Tags</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /tags    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>tags  <span class="token key atrule">Categories</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /categories    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>bookmark  <span class="token key atrule">Archives</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /archives    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>archive  <span class="token key atrule">About</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /about    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>user<span class="token punctuation">-</span>circle  <span class="token comment"># add an English button</span>  <span class="token key atrule">English</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /en  <span class="token comment"># Can fully write https://zcpisme.github.io/en</span>    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>language<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-4-Effect"><a href="#3-4-Effect" class="headerlink" title="3.4, Effect"></a>3.4, Effect</h3><p>After uploading to the two repositories and waiting a moment, you can check the URLs, the effect is as follows:</p><p>Chinese site:</p><p><img src="/en/../images/2/3_ch.png"></p><p>English site:</p><p><img src="/en/../images/2/3_en.png"></p><h3 id="3-5-Disadvantages"><a href="#3-5-Disadvantages" class="headerlink" title="3.5, Disadvantages"></a>3.5, Disadvantages</h3><p>The disadvantages are obvious:</p><ul><li><p>Two repositories need to be maintained separately, which is too troublesome.</p></li><li><p>Article content needs to be prepared separately because this only translates the main interface, the content of the articles still needs to be translated and uploaded individually.</p></li><li><p>Some code still needs to be modified to adapt to the English page. For example, <img src="/en/../images/2/3_enflaw.png" alt="some parts are not in English"></p></li><li><p>……</p></li></ul><h2 id="4-A-Brief-Summary"><a href="#4-A-Brief-Summary" class="headerlink" title="4, A Brief Summary"></a>4, A Brief Summary</h2><p>Here, I’ve dealt with some outdated tutorials from the original document and briefly mentioned some of my personal ideas about language switching. If there is a better way, please let me know! I’m eager to learn.</p>]]></content>
      
      
      <categories>
          
          <category> Personal Website </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo + Github Personal Website Buildup</title>
      <link href="/en/2024/03/04/1_2024-03-03-Hexo%20+%20Github%20Personal%20Website%20Creation/"/>
      <url>/en/2024/03/04/1_2024-03-03-Hexo%20+%20Github%20Personal%20Website%20Creation/</url>
      
        <content type="html"><![CDATA[<hr><blockquote><p>Translated by ChatGPT</p></blockquote><p>As the first post, let’s talk about how this website was made. I’ve wanted to create a personal website for a long time, but I gave up on the idea due to not knowing too much about it. Otherwise, I would have to start learning some strange JavaScript and CSS related stuff from scratch, which would be too torturous for me. However, while chatting yesterday, a friend mentioned, “Don’t you guys have something like a personal portfolio?” I realized I didn’t, but then I suddenly thought about personal websites again. Remembering that professors during my undergraduate days had their own websites, I searched for content related to “personal website creation” again. Surprisingly, there were ready-to-use libraries available, like Hexo, even equipped with various themes. Times have changed, and now everything has become so easy, everything can be generated with one click.</p><p>Thank you, open-source hero.</p><h2 id="First-Step-Configuring-Github"><a href="#First-Step-Configuring-Github" class="headerlink" title="First Step: Configuring Github"></a>First Step: Configuring Github</h2><p>The reason for using Github is simple; for individual users, it provides a free user page, which can perfectly serve as a personal webpage.</p><h3 id="Registering-on-Github"><a href="#Registering-on-Github" class="headerlink" title="Registering on Github"></a>Registering on Github</h3><p>This step is omitted，many tutorial can be found online.</p><h3 id="Generating-id-rsa-and-id-rsa-pub-locally"><a href="#Generating-id-rsa-and-id-rsa-pub-locally" class="headerlink" title="Generating id_rsa and id_rsa.pub locally"></a>Generating id_rsa and id_rsa.pub locally</h3><p>Open a CMD terminal (or Windows PowerShell is recommended), and enter the following commands in sequence</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">git config --global user.name &quot;Github username&quot;git config --global user.email &quot;Github email address&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">ssh-keygen -t rsa -C &quot;Github email address&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>For example, if my GitHub username is <strong>zcpisme</strong>, using <strong><a href="mailto:&#x7a;&#x63;&#x70;&#105;&#x73;&#109;&#101;&#x40;&#117;&#x63;&#x68;&#x69;&#99;&#97;&#103;&#x6f;&#x2e;&#x65;&#100;&#117;">&#x7a;&#x63;&#x70;&#105;&#x73;&#109;&#101;&#x40;&#117;&#x63;&#x68;&#x69;&#99;&#97;&#103;&#x6f;&#x2e;&#x65;&#100;&#117;</a></strong> (an email I made up), then you would enter in the CMD:</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">git config --global user.name &quot;zcpisme&quot;git config --global user.email &quot;zcpisme@uchicago.edu&quot;ssh-keygen -t rsa -C &quot; zcpisme@uchicago.edu&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>Press Enter, and if prompted with y&#x2F;n, type y and press Enter again</p><p>The result is as shown in the image</p><p><img src="/en/../images/1/1_rsakey.png"></p><p>Open the generated id_rsa.pub with Notepad and copy its contents (located on my computer at C:\Users\12427.ssh)</p><p><img src="/en/../images/1/1_rsakey2.png"></p><h3 id="Linking-Github-Account"><a href="#Linking-Github-Account" class="headerlink" title="Linking Github Account"></a>Linking Github Account</h3><p><img src="/en/../images/1/1_gitrsa.png"></p><p>Navigate to your GitHub account —&gt; Settings —&gt; SSH and GPG keys — new SSH key</p><p><img src="/en/../images/1/1_gitrsa2.png"></p><p><img src="/en/../images/1/1_gitrsa3.png"></p><p>For the title, you can choose any name (your email is recommended), and paste the content from the id_rsa.pub you copied earlier into the key section.</p><p>With this, the connection to Github is complete.</p><h3 id="Create-a-Repository-Named-username-github-io"><a href="#Create-a-Repository-Named-username-github-io" class="headerlink" title="Create a Repository Named username.github.io"></a>Create a Repository Named username.github.io</h3><p>At the top right corner, click on the plus sign and select New repository</p><p><img src="/en/../images/1/1_gitio.png"></p><p>For the repository name, enter “yourusername.github.io” <strong>!!! Important: It must be your username followed by .github.io, and each person can only have one such repository, which must be set to public</strong>, then click create repository at the bottom</p><p><img src="/en/../images/1/1_gitio2.png"></p><p>With this, the GitHub setup is complete.</p><h2 id="Step-1-5-Having-Node-js"><a href="#Step-1-5-Having-Node-js" class="headerlink" title="Step 1.5: Having Node.js"></a>Step 1.5: Having Node.js</h2><p>Some might complain, “Ah, zcp, why are you being so verbose?” I say, hold on, my goal is to provide step-by-step instructions, and I also fear that I might forget how to start from scratch and organize tutorials from the web later, so being verbose is better. But for this part, it’s just to inform everyone that it exists and won’t be elaborated on here.</p><p>Node.js is a JavaScript runtime environment, and our subsequent configurations will rely on it.</p><p>For installation tutorials, refer to:</p><p><a href="https://nodejs.org/en">https://nodejs.org/en</a></p><p><a href="https://www.runoob.com/nodejs/nodejs-install-setup.html">https://www.runoob.com/nodejs/nodejs-install-setup.html</a></p><p>Basically, just download and install the MSI image file.</p><p>After installation, you can check if it was successful by entering in cmd:</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">npm -v<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/en/../images/1/1_nodejs.png"></p><h2 id="Step-2-Your-First-Hexo-Personal-Webpage"><a href="#Step-2-Your-First-Hexo-Personal-Webpage" class="headerlink" title="Step 2: Your First Hexo Personal Webpage"></a>Step 2: Your First Hexo Personal Webpage</h2><p>Here we go! With the above configurations, everything that follows becomes foolproof. You neither have to hand-code the webpage yourself nor need any programming knowledge.</p><p>After the previous step, we can use <strong>npm</strong> to manage packages in node.js.</p><h3 id="Installing-Hexo"><a href="#Installing-Hexo" class="headerlink" title="Installing Hexo"></a>Installing Hexo</h3><p>Enter the following command:</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">npm install hexo-cli -g<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Initializing-Hexo"><a href="#Initializing-Hexo" class="headerlink" title="Initializing Hexo"></a>Initializing Hexo</h3><p>For example, if I want to create a folder called myFirstBlog in D:\desktop\campus\personalBlog to manage my webpage, enter this folder in cmd:</p><p><img src="/en/../images/1/1_enterfolder.png"></p><p>Enter:</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">hexo init myFirstBlog<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>As you can see, myFirstBlog has been created.</p><p><img src="/en/../images/1/1_enterfolder2.png"></p><h3 id="Launching-Your-Personal-Website"><a href="#Launching-Your-Personal-Website" class="headerlink" title="Launching Your Personal Website"></a>Launching Your Personal Website</h3><p>Start the server in the folder you just created:</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">hexo -s<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/en/../images/1/1_starthexo.png"></p><p>You can also specify a port with hexo -s -p 4001 for debugging multiple sites (the default port is 4000).</p><p>Copy <a href="http://localhost:4000/">http://localhost:4000/</a> into your browser, and you can (locally) preview your site.</p><p><strong>Congratulations! You now have your own website!</strong><img src="/en/../images/1/1_starthexo2.png"></p><h2 id="Step-3-Hold-on-a-Moment-Publishing-to-Github"><a href="#Step-3-Hold-on-a-Moment-Publishing-to-Github" class="headerlink" title="Step 3: Hold on a Moment (Publishing to Github)"></a>Step 3: Hold on a Moment (Publishing to Github)</h2><p>Of course, we can’t limit ourselves to local previews. We need to publish our webpage to the public internet so that everyone can view it. To do this, follow the configuration steps below.</p><h3 id="Configuring-the-config-yml-File"><a href="#Configuring-the-config-yml-File" class="headerlink" title="Configuring the _config.yml File"></a>Configuring the _config.yml File</h3><p>In the myFirstBlog folder created earlier, there is a file named _config.yml. Open this file with Notepad. Scroll to the very bottom to the #Deployment section, set type to git, repo to the URL of your initial repository followed by .git, and branch to master. For example:</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd"># Deployment## Docs: https:&#x2F;&#x2F;hexo.io&#x2F;docs&#x2F;one-command-deploymentdeploy:  type: git  repo: https:&#x2F;&#x2F;github.com&#x2F;zcpisme&#x2F;zcpisme.github.io.git  branch: master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Publishing"><a href="#Publishing" class="headerlink" title="Publishing"></a>Publishing</h3><p>The last step, in the cmd (still inside the myFirstBlog folder), enter</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">hexo cleanhexo ghexo d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>Wait for the files to upload to GitHub. After a few minutes, username.github.io will be your personal webpage!</p><p><img src="/en/../images/1/1_gitiofinal.png"></p><p>Isn’t it as easy as ABC~</p><h3 id="Common-Hexo-Commands"><a href="#Common-Hexo-Commands" class="headerlink" title="Common Hexo Commands"></a>Common Hexo Commands</h3><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">hexo init [folder] # Initialize hexohexo new [layout] &lt;title&gt; # Create a new post, all posts need to be in markdown (.md) format, by default located in .&#x2F;source&#x2F;_post folderhexo generate # Generate static files, same as hexo ghexo server # Start local server, same as hexo shexo deploy # Deploy website, same as hexo d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h3><p>In personal use, changing and deploying repeatedly, entering commands one by one can be cumbersome (and you might even miss a step). So, you can create a sh script, and run it each time.</p><p>For example, inside the myFirstBlog folder, create a new Notepad document, enter</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token comment"># Stop script on any error</span><span class="token builtin class-name">set</span> <span class="token parameter variable">-e</span><span class="token comment"># Navigate to the Hexo project directory (if not already there)</span><span class="token comment"># Clean the public directory</span><span class="token builtin class-name">echo</span> <span class="token string">"Cleaning..."</span>hexo clean<span class="token comment"># Generate static files</span><span class="token builtin class-name">echo</span> <span class="token string">"Generating..."</span>hexo generate<span class="token comment"># Deploy to the server</span><span class="token builtin class-name">echo</span> <span class="token string">"Deploying..."</span>hexo deploy<span class="token builtin class-name">echo</span> <span class="token string">"Deployment successful!"</span><span class="token builtin class-name">echo</span> <span class="token string">"Press enter to close"</span><span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Rename the file to deploy.sh, before deploying enter</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">.&#x2F;deploy.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Step-Wait-a-Bit-Longer-Optional"><a href="#Step-Wait-a-Bit-Longer-Optional" class="headerlink" title="Step ?: Wait a Bit Longer (Optional)"></a>Step ?: Wait a Bit Longer (Optional)</h2><p>Perhaps some friends are very excited to open the webpage and admire it. Then, they find the webpage design so monotonous, secretly cursing: “This is cheating, cheap goods are not good.” I sneezed twice in front of the screen and said, hold on, again.</p><p>Of course, that’s not the case. The real fun part is coming. There are so many people in the world who contribute out of passion, leading to a wide variety of themes available for Hexo to choose from.</p><p>Here at <a href="https://hexo.io/themes/index.html">Hexo Themes</a> you can pick a theme to your liking, from simple styles to elaborate designs. Currently, <a href="https://theme-next.js.org/docs/">NexT</a> is popular for its simplicity and extensive customization plugins. Here, we’ll choose <a href="https://github.com/blinkfox/hexo-theme-matery?tab=readme-ov-file">hexo-theme-matery</a>, a very beautiful theme. Again, thanks to the open-source heroes, and thank you <a href="https://github.com/blinkfox">Blinkfox</a>.</p><p>After choosing a theme, download the source files (git clone) and copy the downloaded files to the <strong>themes</strong> folder under myFirstBlog.</p><p>Similarly, in the _config.yml configuration file, change the theme to the name of the folder you just downloaded, for example,</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># Extensions</span><span class="token comment">## Plugins: https://hexo.io/plugins/</span><span class="token comment">## Themes: https://hexo.io/themes/</span><span class="token key atrule">theme</span><span class="token punctuation">:</span> hexo<span class="token punctuation">-</span>theme<span class="token punctuation">-</span>matery<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>Publish again, and you can see the webpage theme has become fancier. Usually, each theme has its own detailed documentation.</p><h2 id="Conclusion-of-This-Article"><a href="#Conclusion-of-This-Article" class="headerlink" title="Conclusion of This Article"></a>Conclusion of This Article</h2><p>Exploring an unknown thing is joyful, and there is immense pleasure in the heart when succeeding after repeated trials and errors.</p><p>Thank you for reading my first article, please be forgiving, and suggestions are welcome!</p><p>In the next article, we will talk about some additional settings I have for the matery theme.</p>]]></content>
      
      
      <categories>
          
          <category> Personal Website </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Github </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
